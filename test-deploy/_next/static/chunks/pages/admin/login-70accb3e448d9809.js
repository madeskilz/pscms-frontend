(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[300],{6863:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/login",function(){return n(316)}])},316:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var a=n(5893),r=n(7294),s=n(1163),o=n(1664),i=n.n(o),l=n(610),c=n(990),u=n(762),d=n(1919),m=n(6541),h=n(4677),g=n(6788),f=n(18),x=n(8858),p=n(5895),S=n(3454);function v(){let[e,t]=(0,r.useState)("admin@school.test"),[n,o]=(0,r.useState)(""),[v,j]=(0,r.useState)(""),[w,y]=(0,r.useState)(!0),k=(0,s.useRouter)(),_=(0,r.useRef)(!1);(0,r.useEffect)(()=>{if(!_.current)return _.current=!0,(async()=>{try{let e=sessionStorage.getItem("accessToken");if(e){if((await fetch("".concat(S.env.NEXT_PUBLIC_API_URL||"http://localhost:3001","/api/auth/me"),{headers:{Authorization:"Bearer ".concat(e)}})).ok){let e=sessionStorage.getItem("_lastAuthRedirect"),t=Date.now();(!e||t-parseInt(e)>1e3)&&(sessionStorage.setItem("_lastAuthRedirect",t.toString()),await k.replace("/admin"));return}sessionStorage.clear(),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")}}catch(e){sessionStorage.clear(),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")}finally{y(!1)}})(),()=>{_.current=!1}},[]);let I=async t=>{t.preventDefault(),j("");try{let t=await (0,l.x4)(e,n);sessionStorage.setItem("accessToken",t.accessToken),sessionStorage.setItem("refreshToken",t.refreshToken),k.push("/admin")}catch(e){j(e.message||"Login failed")}};return w?(0,a.jsx)(c.Z,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:(0,a.jsx)(g.Z,{variant:"h6",color:"white",children:"Loading..."})}):(0,a.jsx)(c.Z,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:(0,a.jsx)(u.Z,{sx:{maxWidth:450,width:"100%",mx:2},elevation:8,children:(0,a.jsxs)(d.Z,{sx:{p:4},children:[(0,a.jsxs)(c.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mb:3},children:[(0,a.jsx)(p.Z,{sx:{m:1,bgcolor:"primary.main",width:56,height:56},children:(0,a.jsx)(x.Z,{fontSize:"large"})}),(0,a.jsx)(g.Z,{component:"h1",variant:"h4",fontWeight:700,children:"Admin Login"}),(0,a.jsx)(g.Z,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Sign in to manage your school CMS"})]}),(0,a.jsxs)(c.Z,{component:"form",onSubmit:I,noValidate:!0,children:[(0,a.jsx)(m.Z,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:e,onChange:e=>t(e.target.value)}),(0,a.jsx)(m.Z,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:n,onChange:e=>o(e.target.value)}),v&&(0,a.jsx)(f.Z,{severity:"error",sx:{mt:2},children:v}),(0,a.jsx)(h.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:1,py:1.5,fontSize:"1rem",fontWeight:600},children:"Sign In"}),(0,a.jsx)(h.Z,{component:i(),href:"/",fullWidth:!0,variant:"text",sx:{mt:.5},children:"‚Üê Back to Home"})]})]})})})}}},function(e){e.O(0,[737,736,888,179],function(){return e(e.s=6863)}),_N_E=e.O()}]);