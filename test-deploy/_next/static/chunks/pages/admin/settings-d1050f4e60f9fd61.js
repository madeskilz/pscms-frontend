(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[577],{9014:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/settings",function(){return s(6464)}])},6464:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return L}});var a=s(5893),i=s(7294),r=s(1163),l=s(610),n=s(2181),o=s(8007),d=s(1664),c=s.n(d),h=s(1032),x=s(8573),u=s(762),p=s(1919),j=s(1359),Z=s(6788),m=s(990),g=s(4677),f=s(18),b=s(1873),v=s(6541),y=s(2857),S=s(1574),w=s(9591),C=s(4022),T=s(9204),k=s(6897),I=s(8649),F=s(5083),H=s(5972),W=s(607),_=s(2200),P=s(9132),E=s(5678),z=s(6942),N=s(1051),B=s(4453),O=s(2591),R=s(2942),A=s(9478);function L(){var e;let[t,s]=(0,i.useState)(null),[d,L]=(0,i.useState)(!1),[D,M]=(0,i.useState)(""),[X,q]=(0,i.useState)({heroTitle:"",heroSubtitle:"",ctaText:"",ctaHref:"",postsSectionTitle:"Latest Posts",features:[]}),[J,V]=(0,i.useState)([]),[$,G]=(0,i.useState)([]),[K,Q]=(0,i.useState)(!0),U=(0,r.useRouter)(),{currentThemeId:Y,setCurrentThemeId:ee}=(0,o.F)();(0,i.useEffect)(()=>{let e=sessionStorage.getItem("accessToken");if(!e){U.push("/admin/login");return}s(e),et(e)},[U]);let et=async e=>{try{let[t,s]=await Promise.all([(0,l.$8)("homepage"),(0,l.Jq)(e,1,"post")]);t&&(q(e=>({...e,...t})),V(t.featuredPostIds||[])),G((null==s?void 0:s.data)||[])}catch(e){}finally{Q(!1)}},es=async e=>{L(!0),M("");try{await (0,l.m7)("theme",{active:e},t),ee(e),M("Theme updated successfully!"),setTimeout(()=>M(""),3e3)}catch(e){M("Failed to update theme")}finally{L(!1)}},ea=async()=>{L(!0),M("");try{await (0,l.m7)("homepage",{...X,featuredPostIds:J},t),M("Homepage settings updated successfully!"),setTimeout(()=>M(""),3e3)}catch(e){M("Failed to update homepage settings")}finally{L(!1)}},ei=(e,t,s)=>{q(a=>({...a,features:a.features.map((a,i)=>i===e?{...a,[t]:s}:a)}))},er=e=>{q(t=>({...t,features:t.features.filter((t,s)=>s!==e)}))};return t?(0,a.jsx)(A.Z,{title:"Site Settings",backHref:"/admin",children:(0,a.jsxs)(h.Z,{maxWidth:"lg",sx:{py:0},children:[(0,a.jsx)(u.Z,{elevation:3,sx:{mb:4},children:(0,a.jsxs)(p.Z,{children:[(0,a.jsxs)(Z.Z,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[(0,a.jsx)(E.Z,{color:"primary"}),"Theme Selection"]}),(0,a.jsx)(Z.Z,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Choose a theme for your school website"}),D&&(0,a.jsx)(f.Z,{severity:D.includes("success")?"success":"error",sx:{mb:3},children:D}),(0,a.jsx)(x.ZP,{container:!0,spacing:3,children:Object.entries(n.n).map(e=>{let[t,s]=e;return(0,a.jsx)(x.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,a.jsx)(u.Z,{elevation:Y===t?8:2,sx:{border:2,borderColor:Y===t?"primary.main":"grey.200",position:"relative"},children:(0,a.jsx)(j.Z,{onClick:()=>!d&&es(t),children:(0,a.jsxs)(p.Z,{children:[(0,a.jsxs)(m.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"start",mb:2},children:[(0,a.jsx)(Z.Z,{variant:"h6",component:"h3",fontWeight:700,children:s.name}),Y===t&&(0,a.jsx)(P.Z,{color:"primary"})]}),(0,a.jsx)(Z.Z,{variant:"body2",color:"text.secondary",sx:{mb:2},children:s.description}),(0,a.jsxs)(m.Z,{sx:{display:"flex",gap:1},children:[(0,a.jsx)(m.Z,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:s.colors.primary,border:"2px solid white",boxShadow:1}}),(0,a.jsx)(m.Z,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:s.colors.secondary,border:"2px solid white",boxShadow:1}}),(0,a.jsx)(m.Z,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:s.colors.accent,border:"2px solid white",boxShadow:1}})]}),Y===t&&(0,a.jsx)(b.Z,{label:"Active",color:"primary",size:"small",sx:{mt:2}})]})})})},t)})})]})}),(0,a.jsx)(u.Z,{elevation:3,sx:{mb:4},children:(0,a.jsxs)(p.Z,{children:[(0,a.jsxs)(Z.Z,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[(0,a.jsx)(z.Z,{color:"primary"}),"Homepage Content"]}),(0,a.jsx)(Z.Z,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Customize your homepage hero, features, and featured posts"}),(0,a.jsxs)(w.Z,{defaultExpanded:!0,children:[(0,a.jsx)(C.Z,{expandIcon:(0,a.jsx)(N.Z,{}),children:(0,a.jsx)(Z.Z,{variant:"h6",children:"Hero Section"})}),(0,a.jsx)(T.Z,{children:(0,a.jsxs)(S.Z,{spacing:2,children:[(0,a.jsx)(v.Z,{label:"Hero Title",value:X.heroTitle,onChange:e=>q(t=>({...t,heroTitle:e.target.value})),fullWidth:!0}),(0,a.jsx)(v.Z,{label:"Hero Subtitle",value:X.heroSubtitle,onChange:e=>q(t=>({...t,heroSubtitle:e.target.value})),fullWidth:!0,multiline:!0,rows:2}),(0,a.jsx)(v.Z,{label:"CTA Button Text",value:X.ctaText,onChange:e=>q(t=>({...t,ctaText:e.target.value})),fullWidth:!0}),(0,a.jsx)(v.Z,{label:"CTA Button Link",value:X.ctaHref,onChange:e=>q(t=>({...t,ctaHref:e.target.value})),fullWidth:!0,placeholder:"/about"}),(0,a.jsx)(v.Z,{label:"Posts Section Title",value:X.postsSectionTitle,onChange:e=>q(t=>({...t,postsSectionTitle:e.target.value})),fullWidth:!0})]})})]}),(0,a.jsxs)(w.Z,{children:[(0,a.jsx)(C.Z,{expandIcon:(0,a.jsx)(N.Z,{}),children:(0,a.jsx)(Z.Z,{variant:"h6",children:"Features (Optional)"})}),(0,a.jsx)(T.Z,{children:(0,a.jsxs)(S.Z,{spacing:2,children:[null===(e=X.features)||void 0===e?void 0:e.map((e,t)=>(0,a.jsx)(m.Z,{sx:{p:2,border:"1px solid",borderColor:"divider",borderRadius:1},children:(0,a.jsxs)(S.Z,{spacing:2,children:[(0,a.jsxs)(m.Z,{sx:{display:"flex",gap:2,alignItems:"flex-start"},children:[(0,a.jsx)(v.Z,{label:"Feature Title",value:e.title,onChange:e=>ei(t,"title",e.target.value),size:"small",sx:{flex:1}}),(0,a.jsx)(y.Z,{color:"error",onClick:()=>er(t),children:(0,a.jsx)(B.Z,{})})]}),(0,a.jsx)(v.Z,{label:"Feature Description",value:e.text,onChange:e=>ei(t,"text",e.target.value),multiline:!0,rows:2,size:"small",fullWidth:!0})]})},t)),(0,a.jsx)(g.Z,{startIcon:(0,a.jsx)(O.Z,{}),variant:"outlined",onClick:()=>{q(e=>({...e,features:[...e.features,{title:"New Feature",text:"Description here"}]}))},children:"Add Feature"})]})})]}),(0,a.jsxs)(w.Z,{children:[(0,a.jsx)(C.Z,{expandIcon:(0,a.jsx)(N.Z,{}),children:(0,a.jsxs)(Z.Z,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1},children:[(0,a.jsx)(R.Z,{color:"warning"}),"Featured Posts"]})}),(0,a.jsxs)(T.Z,{children:[(0,a.jsxs)(k.Z,{fullWidth:!0,children:[(0,a.jsx)(I.Z,{children:"Select Featured Posts"}),(0,a.jsx)(F.Z,{multiple:!0,value:J,onChange:e=>{V(e.target.value)},renderValue:e=>"".concat(e.length," post").concat(1!==e.length?"s":""," selected"),children:$.filter(e=>"published"===e.status).map(e=>(0,a.jsxs)(H.Z,{value:e.id,children:[(0,a.jsx)(W.Z,{checked:J.indexOf(e.id)>-1}),(0,a.jsx)(_.Z,{primary:e.title})]},e.id))})]}),(0,a.jsx)(Z.Z,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:"Featured posts can be displayed prominently on your homepage"})]})]}),(0,a.jsx)(m.Z,{sx:{mt:3},children:(0,a.jsx)(g.Z,{variant:"contained",onClick:ea,disabled:d,children:d?"Saving...":"Save Homepage Settings"})})]})}),(0,a.jsx)(u.Z,{elevation:3,children:(0,a.jsxs)(p.Z,{children:[(0,a.jsx)(Z.Z,{variant:"h5",gutterBottom:!0,children:"Content Management"}),(0,a.jsx)(Z.Z,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Manage your site's hero section and features"}),(0,a.jsxs)(m.Z,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[(0,a.jsx)(g.Z,{component:c(),href:"/admin/hero",variant:"outlined",size:"large",sx:{minWidth:200},children:"Edit Hero Section"}),(0,a.jsx)(g.Z,{component:c(),href:"/admin/features",variant:"outlined",size:"large",sx:{minWidth:200},children:"Edit Features Section"})]})]})})]})}):(0,a.jsx)(m.Z,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(Z.Z,{children:"Loading..."})})}}},function(e){e.O(0,[737,736,592,888,179],function(){return e(e.s=9014)}),_N_E=e.O()}]);