(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[299],{3547:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/media",function(){return i(9411)}])},9411:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return j}});var n=i(5893),a=i(7294),s=i(1163),l=i(610);i(1664);var r=i(1032),c=i(8573),o=i(762),d=i(1919),u=i(7093),x=i(4677),h=i(6788),m=i(990),p=i(18),f=i(863),y=i(1596),g=i(9478);function j(){let[e,t]=(0,a.useState)(null),[i,j]=(0,a.useState)([]),[Z,b]=(0,a.useState)(!1),[v,_]=(0,a.useState)(""),[w,k]=(0,a.useState)(""),S=(0,s.useRouter)();(0,a.useEffect)(()=>{let e=sessionStorage.getItem("accessToken");if(!e){S.push("/admin/login");return}t(e),N(e)},[S]);let N=async e=>{try{let t=await (0,l.I0)(e);j(t.data||[])}catch(e){_("Failed to load media")}},E=async t=>{t.preventDefault();let i=t.target.elements.file.files[0];if(i){b(!0),_(""),k("");try{await (0,l.$i)(i,e),t.target.reset(),await N(e),k("File uploaded successfully!"),setTimeout(()=>k(""),3e3)}catch(e){_(e.message||"Upload failed")}finally{b(!1)}}};return e?(0,n.jsx)(g.Z,{title:"Media Library",backHref:"/admin",children:(0,n.jsxs)(r.Z,{maxWidth:"lg",sx:{py:0},children:[(0,n.jsx)(o.Z,{elevation:3,sx:{mb:4},children:(0,n.jsxs)(d.Z,{children:[(0,n.jsxs)(h.Z,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[(0,n.jsx)(f.Z,{color:"primary"}),"Upload New File"]}),(0,n.jsxs)(m.Z,{component:"form",onSubmit:E,sx:{mt:2},children:[(0,n.jsxs)(x.Z,{variant:"outlined",component:"label",fullWidth:!0,sx:{py:2,mb:2},children:["Choose File",(0,n.jsx)("input",{type:"file",name:"file",hidden:!0})]}),v&&(0,n.jsx)(p.Z,{severity:"error",sx:{mb:2},children:v}),w&&(0,n.jsx)(p.Z,{severity:"success",sx:{mb:2},children:w}),(0,n.jsx)(x.Z,{type:"submit",variant:"contained",fullWidth:!0,disabled:Z,sx:{py:1.5},children:Z?"Uploading...":"Upload"})]})]})}),(0,n.jsxs)(h.Z,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,mb:3},children:[(0,n.jsx)(y.Z,{color:"primary"}),"All Files"]}),0===i.length&&(0,n.jsx)(h.Z,{variant:"body1",color:"text.secondary",align:"center",sx:{py:4},children:"No files uploaded yet."}),(0,n.jsx)(c.ZP,{container:!0,spacing:3,children:i.map(e=>(0,n.jsx)(c.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,n.jsxs)(o.Z,{elevation:2,children:[(0,n.jsx)(u.Z,{component:"img",height:"200",image:"http://localhost:3001".concat(e.url),alt:e.alt_text||e.title,sx:{objectFit:"cover",bgcolor:"grey.200"}}),(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(h.Z,{variant:"h6",gutterBottom:!0,noWrap:!0,children:e.title||"(Untitled)"}),(0,n.jsx)(h.Z,{variant:"caption",color:"text.secondary",display:"block",children:e.mime_type}),(0,n.jsx)(h.Z,{variant:"caption",color:"text.secondary",display:"block",children:new Date(e.created_at).toLocaleDateString()})]})]})},e.id))})]})}):(0,n.jsx)(m.Z,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsx)(h.Z,{children:"Loading..."})})}}},function(e){e.O(0,[737,736,592,888,179],function(){return e(e.s=3547)}),_N_E=e.O()}]);